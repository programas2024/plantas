<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PlantID - Identificador de Plantas 🌿</title>
  <!-- TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <!-- Teachable Machine (imagen) -->
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
  <!-- SweetAlert -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --primary: #2e7d32;
      --primary-light: #4caf50;
      --secondary: #8bc34a;
      --accent: #ff9800;
      --light: #f1f8e9;
      --dark: #1b5e20;
      --text: #212121;
      --text-light: #757575;
      --card-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--light) 0%, #e8f5e9 100%);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    header {
      background: linear-gradient(to right, var(--primary), var(--primary-light));
      color: white;
      padding: 15px 0;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      border-radius: 15px;
      margin-bottom: 30px;
    }
    
    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1.8rem;
      font-weight: 600;
    }
    
    .nav-buttons {
      display: flex;
      gap: 15px;
    }
    
    .nav-btn {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 50px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .nav-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }
    
    .hero {
      text-align: center;
      padding: 40px 20px;
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
      margin-bottom: 40px;
    }
    
    .hero h1 {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: var(--dark);
    }
    
    .hero p {
      font-size: 1.2rem;
      color: var(--text-light);
      max-width: 700px;
      margin: 0 auto 30px;
    }
    
    .main-content {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      justify-content: center;
      margin-bottom: 40px;
    }
    
    .upload-section {
      flex: 1;
      min-width: 300px;
      max-width: 500px;
    }
    
    .info-section {
      flex: 1;
      min-width: 300px;
      max-width: 600px;
    }
    
    .card {
      background: white;
      border-radius: 18px;
      padding: 25px;
      box-shadow: var(--card-shadow);
      margin-bottom: 25px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
    }
    
    .card-title {
      color: var(--primary);
      font-size: 1.4rem;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .upload-options {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }
    
    .upload-option {
      background: var(--light);
      border: 2px dashed var(--secondary);
      border-radius: 12px;
      padding: 25px 15px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .upload-option:hover {
      background: #e8f5e9;
      border-color: var(--primary);
      transform: translateY(-3px);
    }
    
    .upload-icon {
      font-size: 2.5rem;
      color: var(--primary);
      margin-bottom: 15px;
    }
    
    .btn {
      display: inline-block;
      background: var(--primary);
      color: white;
      padding: 14px 25px;
      border-radius: 50px;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 500;
      transition: all 0.3s ease;
      text-align: center;
      width: 100%;
      margin-top: 10px;
    }
    
    .btn:hover {
      background: var(--dark);
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    
    .btn-outline {
      background: transparent;
      border: 2px solid var(--primary);
      color: var(--primary);
    }
    
    .btn-outline:hover {
      background: var(--primary);
      color: white;
    }
    
    .btn-accent {
      background: var(--accent);
    }
    
    .btn-accent:hover {
      background: #f57c00;
    }
    
    #preview-container {
      position: relative;
      margin: 20px 0;
      display: none;
      text-align: center;
    }
    
    #preview {
      max-width: 100%;
      max-height: 400px;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .instructions {
      background: #e8f5e9;
      padding: 20px;
      border-radius: 12px;
      margin-top: 20px;
    }
    
    .instructions h3 {
      color: var(--primary);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .instructions ol {
      padding-left: 20px;
      text-align: left;
    }
    
    .instructions li {
      margin-bottom: 10px;
      line-height: 1.5;
    }
    
    .result-placeholder {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-light);
    }
    
    .result-placeholder i {
      font-size: 4rem;
      margin-bottom: 20px;
      color: #ddd;
    }
    
    .plant-info {
      display: none;
    }
    
    .info-item {
      margin-bottom: 15px;
      display: flex;
      align-items: flex-start;
    }
    
    .info-icon {
      color: var(--primary);
      margin-right: 12px;
      font-size: 1.2rem;
      margin-top: 3px;
    }
    
    .info-content {
      flex: 1;
    }
    
    .info-label {
      font-weight: 600;
      color: var(--dark);
      display: block;
      margin-bottom: 5px;
    }
    
    footer {
      text-align: center;
      padding: 30px;
      color: var(--text-light);
      font-size: 0.9rem;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
    }
    
    .loading {
      display: none;
      text-align: center;
      padding: 20px;
    }
    
    .loading-spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid var(--primary);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .camera-help {
      background: #fff8e1;
      border-left: 4px solid var(--accent);
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
      text-align: left;
    }
    
    .camera-help h4 {
      color: var(--accent);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    @media (max-width: 768px) {
      .upload-options {
        grid-template-columns: 1fr;
      }
      
      .main-content {
        flex-direction: column;
      }
      
      .header-content {
        flex-direction: column;
        gap: 15px;
      }
      
      .nav-buttons {
        width: 100%;
        justify-content: center;
      }
      
      .hero h1 {
        font-size: 2rem;
      }
      
      .hero p {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-content">
        <div class="logo">
          <i class="fas fa-leaf"></i>
          <span>PlantID</span>
        </div>
        <div class="nav-buttons">
          <button class="nav-btn" id="aboutBtn">
            <i class="fas fa-info-circle"></i> Acerca de
          </button>
          <button class="nav-btn" id="safireBtn">
            <i class="fas fa-star"></i> Safire
          </button>
        </div>
      </div>
    </header>
    
    <section class="hero">
      <h1>Identificador de Plantas Medicinales</h1>
      <p>Descubre información sobre plantas medicinales y sus propiedades con solo una foto</p>
    </section>
    
    <div class="main-content">
      <div class="upload-section">
        <div class="card">
          <h2 class="card-title"><i class="fas fa-camera"></i> Identificar planta</h2>
          
          <div class="upload-options">
            <div class="upload-option" id="uploadGallery">
              <div class="upload-icon">
                <i class="fas fa-folder-open"></i>
              </div>
              <p>Desde la galería</p>
            </div>
            
            <div class="upload-option" id="openCamera">
              <div class="upload-icon">
                <i class="fas fa-camera"></i>
              </div>
              <p>Tomar foto</p>
            </div>
          </div>
          
          <input type="file" id="fileInput" accept="image/*" hidden>
          
          <div id="preview-container">
            <img id="preview">
            <div style="margin-top: 20px;">
              <button class="btn" id="analyzeBtn">
                <i class="fas fa-search"></i> Analizar planta
              </button>
              <button class="btn btn-outline" id="cancelBtn">
                <i class="fas fa-times"></i> Cancelar
              </button>
            </div>
          </div>
          
          <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p>Analizando imagen...</p>
          </div>
          
          <div class="camera-help">
            <h4><i class="fas fa-info-circle"></i> ¿Cómo tomar la foto?</h4>
            <p>Haz clic en "Tomar foto" para abrir la aplicación de cámara de tu dispositivo. Después de tomar la foto, regresa aquí y sube la imagen.</p>
          </div>
        </div>
        
        <div class="card">
          <h2 class="card-title"><i class="fas fa-lightbulb"></i> Consejos para mejores resultados</h2>
          <ul style="padding-left: 20px;">
            <li>Asegúrate de que la planta esté bien iluminada</li>
            <li>Enfoca claramente las hojas o flores</li>
            <li>Toma la foto sobre un fondo neutro si es posible</li>
            <li>Acércate lo suficiente para ver los detalles</li>
            <li>Toma fotos desde diferentes ángulos para mejor identificación</li>
          </ul>
        </div>
      </div>
      
      <div class="info-section">
        <div class="card">
          <h2 class="card-title"><i class="fas fa-info-circle"></i> Información de la planta</h2>
          
          <div class="result-placeholder" id="resultPlaceholder">
            <i class="fas fa-seedling"></i>
            <p>La información de la planta identificada aparecerá aquí</p>
          </div>
          
          <div class="plant-info" id="plantInfo">
            <!-- La información de la planta se insertará aquí -->
          </div>
        </div>
        
        <div class="card">
          <h2 class="card-title"><i class="fas fa-book-medical"></i> Plantas identificables</h2>
          <div class="info-item">
            <div class="info-icon">
              <i class="fas fa-leaf"></i>
            </div>
            <div class="info-content">
              <span class="info-label">Sauco</span>
              <span>Sambucus nigra - Usado para resfriados y afecciones de la piel</span>
            </div>
          </div>
          
          <div class="info-item">
            <div class="info-icon">
              <i class="fas fa-leaf"></i>
            </div>
            <div class="info-content">
              <span class="info-label">Manzanilla</span>
              <span>Matricaria chamomilla - Relajante y ayuda digestiva</span>
            </div>
          </div>
          
          <div class="info-item">
            <div class="info-icon">
              <i class="fas fa-leaf"></i>
            </div>
            <div class="info-content">
              <span class="info-label">Sábila</span>
              <span>Aloe vera - Cicatrizante e hidratante natural</span>
            </div>
          </div>
          
          <div class="info-item">
            <div class="info-icon">
              <i class="fas fa-leaf"></i>
            </div>
            <div class="info-content">
              <span class="info-label">Menta</span>
              <span>Mentha spp. - Digestiva y refrescante</span>
            </div>
          </div>
          
          <div class="info-item">
            <div class="info-icon">
              <i class="fas fa-leaf"></i>
            </div>
            <div class="info-content">
              <span class="info-label">Romero</span>
              <span>Rosmarinus officinalis - Estimulante circulatorio y memoria</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="instructions">
      <h3><i class="fas fa-question-circle"></i> ¿Cómo funciona?</h3>
      <ol>
        <li><strong>Toma una foto</strong> de la planta con la cámara de tu dispositivo o <strong>sube una imagen</strong> desde tu galería</li>
        <li>Nuestro sistema <strong>analizará la imagen</strong> usando inteligencia artificial</li>
        <li>Obtendrás <strong>información detallada</strong> sobre la planta identificada</li>
        <li>Descubre sus <strong>propiedades medicinales</strong> y <strong>usos tradicionales</strong></li>
      </ol>
    </div>
  </div>
  
  <footer>
    <div class="container">
      <p>PlantID - Identificador de Plantas Medicinales © 2023</p>
      <p>Hecho con <i class="fas fa-heart" style="color: #e91e63;"></i> para amantes de la naturaleza</p>
    </div>
  </footer>

  <script>
    // Elementos DOM
    const fileInput = document.getElementById('fileInput');
    const uploadGallery = document.getElementById('uploadGallery');
    const openCamera = document.getElementById('openCamera');
    const previewContainer = document.getElementById('preview-container');
    const preview = document.getElementById('preview');
    const analyzeBtn = document.getElementById('analyzeBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    const loading = document.getElementById('loading');
    const resultPlaceholder = document.getElementById('resultPlaceholder');
    const plantInfo = document.getElementById('plantInfo');
    const aboutBtn = document.getElementById('aboutBtn');
    const safireBtn = document.getElementById('safireBtn');

    let model;

    // 📚 Base de datos de plantas
    const plantasDB = {
      "sauco": {
        nombre: "Sauco",
        cientifico: "Sambucus nigra",
        origen: "Europa y América del Norte",
        usos: "Infusiones para resfriados, ungüentos para la piel",
        observacion: "Tóxica en exceso, usar con precaución",
        propiedades: "Antiviral, antiinflamatorio, diaforético"
      },
      "manzanilla": {
        nombre: "Manzanilla",
        cientifico: "Matricaria chamomilla",
        origen: "Europa y Asia",
        usos: "Relajante, ayuda digestiva, calmante natural",
        observacion: "Segura en infusión, no abusar en embarazo",
        propiedades: "Calmante, antiespasmódica, antiinflamatoria"
      },
      "sabina": {
        nombre: "Sábila (Aloe vera)",
        cientifico: "Aloe vera",
        origen: "África del Norte",
        usos: "Gel cicatrizante, hidratación de piel, quemaduras",
        observacion: "No ingerir en exceso, puede ser laxante fuerte",
        propiedades: "Cicatrizante, hidratante, antiinflamatorio"
      },
      "menta": {
        nombre: "Menta",
        cientifico: "Mentha spp.",
        origen: "Europa, Asia y África",
        usos: "Infusiones digestivas, ambientador natural",
        observacion: "Evitar en niños pequeños y embarazo",
        propiedades: "Digestiva, antiséptica, refrescante"
      },
      "romero": {
        nombre: "Romero",
        cientifico: "Rosmarinus officinalis",
        origen: "Región mediterránea",
        usos: "Estimulante circulatorio, mejora la memoria",
        observacion: "Evitar en casos de hipertensión",
        propiedades: "Estimulante, antioxidante, antiséptico"
      }
    };

    // 🚀 Cargar el modelo entrenado
    async function loadModel() {
      try {
        // Simulamos la carga del modelo con un retraso
        await new Promise(resolve => setTimeout(resolve, 1500));
        console.log("✅ Modelo cargado (simulado)");
      } catch (error) {
        console.error("Error cargando el modelo:", error);
        Swal.fire({
          icon: 'error',
          title: 'Error',
          text: 'No se pudo cargar el modelo de identificación. Por favor, recarga la página.'
        });
      }
    }

    // Inicializar la aplicación
    function init() {
      loadModel();
      setupEventListeners();
    }
    
    // Configurar event listeners
    function setupEventListeners() {
      // Subir desde galería
      uploadGallery.addEventListener('click', () => {
        fileInput.click();
      });
      
      // Abrir cámara del sistema operativo
      openCamera.addEventListener('click', () => {
        // Crear un input de tipo file con atributo capture para abrir la cámara
        const cameraInput = document.createElement('input');
        cameraInput.type = 'file';
        cameraInput.accept = 'image/*';
        cameraInput.capture = 'environment';
        
        // Simular clic en el input para abrir la cámara
        cameraInput.click();
        
        // Manejar la selección de archivo
        cameraInput.addEventListener('change', handleFileSelect);
      });
      
      // Manejar selección de archivo
      fileInput.addEventListener('change', handleFileSelect);
      
      // Analizar y cancelar
      analyzeBtn.addEventListener('click', analyzeImage);
      cancelBtn.addEventListener('click', resetInterface);
      
      // Botones de información
      aboutBtn.addEventListener('click', () => {
        Swal.fire({
          title: 'Acerca de PlantID',
          html: `
            <p>PlantID es una aplicación que utiliza inteligencia artificial para identificar plantas medicinales y mostrar información sobre sus propiedades, usos tradicionales y precauciones.</p>
            <div style="text-align: left; margin-top: 15px;">
              <h3>Cómo funciona</h3>
              <ol>
                <li>Toma una foto de la planta con tu cámara</li>
                <li>Nuestro sistema analizará la imagen</li>
                <li>Obtendrás información detallada sobre la planta</li>
              </ol>
            </div>
          `,
          confirmButtonText: 'Entendido'
        });
      });
      
      safireBtn.addEventListener('click', () => {
        Swal.fire({
          title: 'Safire',
          html: `
            <p>Safire es una funcionalidad premium que te permite:</p>
            <ul style="text-align: left;">
              <li>Identificar un catálogo más amplio de plantas</li>
              <li>Obtener información más detallada sobre usos medicinales</li>
              <li>Recibir recomendaciones personalizadas</li>
              <li>Acceder a recetas tradicionales</li>
            </ul>
            <p style="margin-top: 15px;">Próximamente estará disponible para todos.</p>
          `,
          confirmButtonText: 'Entendido'
        });
      });
    }
    
    // Manejar selección de archivo
    function handleFileSelect(e) {
      const file = e.target.files[0];
      if (!file) return;
      
      showPreview(URL.createObjectURL(file));
    }
    
    // Mostrar vista previa
    function showPreview(src) {
      preview.src = src;
      previewContainer.style.display = 'block';
    }
    
    // Analizar imagen
    async function analyzeImage() {
      loading.style.display = 'block';
      previewContainer.style.display = 'none';
      
      try {
        // Simulamos el análisis con un retraso
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        // Para esta demo, seleccionamos una planta aleatoria
        const plantKeys = Object.keys(plantasDB);
        const randomPlant = plantKeys[Math.floor(Math.random() * plantKeys.length)];
        
        mostrarResultado(randomPlant);
      } catch (error) {
        console.error("Error analizando imagen:", error);
        Swal.fire({
          icon: 'error',
          title: 'Error',
          text: 'No se pudo analizar la imagen. Por favor, intenta con otra foto.'
        });
      } finally {
        loading.style.display = 'none';
      }
    }
    
    // Mostrar resultado
    function mostrarResultado(plantaId) {
      const data = plantasDB[plantaId];
      
      if (!data) {
        Swal.fire({
          icon: 'warning',
          title: 'Planta no identificada',
          text: 'No pudimos identificar esta planta con certeza. Intenta con una foto más clara.'
        });
        resetInterface();
        return;
      }
      
      // Ocultar placeholder y mostrar info
      resultPlaceholder.style.display = 'none';
      plantInfo.style.display = 'block';
      
      // Construir HTML de la información
      plantInfo.innerHTML = `
        <h3 style="color: var(--primary); margin-bottom: 20px; font-size: 1.6rem;">
          <i class="fas fa-seedling" style="color: var(--primary);"></i> ${data.nombre}
        </h3>
        
        <div class="info-item">
          <div class="info-icon">
            <i class="fas fa-signature"></i>
          </div>
          <div class="info-content">
            <span class="info-label">Nombre científico</span>
            <span>${data.cientifico}</span>
          </div>
        </div>
        
        <div class="info-item">
          <div class="info-icon">
            <i class="fas fa-globe-americas"></i>
          </div>
          <div class="info-content">
            <span class="info-label">Origen</span>
            <span>${data.origen}</span>
          </div>
        </div>
        
        <div class="info-item">
          <div class="info-icon">
            <i class="fas fa-mortar-pestle"></i>
          </div>
          <div class="info-content">
            <span class="info-label">Usos tradicionales</span>
            <span>${data.usos}</span>
          </div>
        </div>
        
        <div class="info-item">
          <div class="info-icon">
            <i class="fas fa-heart"></i>
          </div>
          <div class="info-content">
            <span class="info-label">Propiedades medicinales</span>
            <span>${data.propiedades}</span>
          </div>
        </div>
        
        <div class="info-item">
          <div class="info-icon">
            <i class="fas fa-exclamation-triangle"></i>
          </div>
          <div class="info-content">
            <span class="info-label">Precauciones</span>
            <span>${data.observacion}</span>
          </div>
        </div>
        
        <div style="margin-top: 25px; text-align: center;">
          <button class="btn" onclick="resetInterface()">
            <i class="fas fa-redo"></i> Identificar otra planta
          </button>
        </div>
      `;
    }
    
    // Reiniciar interfaz
    function resetInterface() {
      fileInput.value = '';
      previewContainer.style.display = 'none';
      
      // Restablecer sección de resultados
      plantInfo.style.display = 'none';
      plantInfo.innerHTML = '';
      resultPlaceholder.style.display = 'block';
    }
    
    // Inicializar cuando el DOM esté listo
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>